<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>CrossTalkeR Example - Human Myelofibrosis • CrossTalkeR</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet">
<meta property="og:title" content="CrossTalkeR Example - Human Myelofibrosis">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">


    <div class="container template-article">
      <header><div class="navbar navbar-dark navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">CrossTalkeR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.4.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../articles/CrossTalkeR.html">Get started</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Tutorials

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/CrossTalker_basicusage.html">CrossTalkeR 101</a>
    </li>
    <li>
      <a href="../articles/HumanFibrosis.html">Example: Bone Marrow Fibrosis (Leimkuhler et. al., 2021)</a>
    </li>
    <li>
      <a href="../articles/LR2TF_analysis.html">Transcription Factor Activity Analysis</a>
    </li>
    <li>
      <a href="../articles/MyocardialInfarction.html">Example: Heart Myocardial Infarcition (Kuppe et. al., 2022)</a>
    </li>
    <li>
      <a href="../articles/run_liana.html">Ligand-Receptor Inference with Liana</a>
    </li>
  </ul>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
<li>
  <a href="../articles/Install.html">Install</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/CostaLab/CrossTalkeR/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->



      </header><script src="HumanFibrosis_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>CrossTalkeR Example - Human Myelofibrosis</h1>
                        <h4 data-toc-skip class="author">James S. Nagai</h4>
            <address class="author_afil">
      Institute for Computational Genomics, Faculty of Medicine, RWTH Aachen University, Aachen, 52074 Germany<br><h4 data-toc-skip class="author">Vanessa Klöker</h4>
            <address class="author_afil">
      Institute for Computational Genomics, Faculty of Medicine, RWTH Aachen University, Aachen, 52074 Germany<br><h4 data-toc-skip class="author">Ivan G. Costa</h4>
            <address class="author_afil">
      Institute for Computational Genomics, Faculty of Medicine, RWTH Aachen University, Aachen, 52074 Germany<br><small class="dont-index">Source: <a href="https://github.com/CostaLab/CrossTalkeR/blob/HEAD/vignettes/HumanFibrosis.rmd" class="external-link"><code>vignettes/HumanFibrosis.rmd</code></a></small>
      <div class="hidden name"><code>HumanFibrosis.rmd</code></div>

    </address>
</address>
</address>
</div>

    
    
<div class="section level2">
<h2 id="cell-cell-communication-analysis-of-human-myelofibrosis-scrna-seq-data-using-crosstalker">Cell-Cell Communication Analysis of Human Myelofibrosis scRNA-seq Data Using CrossTalkeR<a class="anchor" aria-label="anchor" href="#cell-cell-communication-analysis-of-human-myelofibrosis-scrna-seq-data-using-crosstalker"></a>
</h2>
<p>Here, we demonstrate the usage of CrossTalkeR on the case study Myelofibrosis scRNA-seq data set from the paper. The predicted ligand-receptor interactions used in this tutorial are provided within this package. These differ sightly from the results presented in the paper, since they were recomputed using the cellphoneDB Method with the liana package and the consensus interaction database.</p>
<p>The scRNA-seq data contains two conditions: control (CTR_LR.csv) and disease condition (EXP_LR.csv). We first show how to run liana to retrieve ligand and receptor activities, then how to execute CrossTalkeR and finally go over some of the results, that are also provided inside the resulting CrossTalkeR report.</p>
<div class="section level3">
<h3 id="run-liana-for-ligand-receptor-interaction-prediction-in-python">Run liana for Ligand-Receptor Interaction Prediction in Python<a class="anchor" aria-label="anchor" href="#run-liana-for-ligand-receptor-interaction-prediction-in-python"></a>
</h3>
<p>For the prediction of ligand-receptor interactions, we use the python version of the package <a href="https://liana-py.readthedocs.io/en/latest/" class="external-link">liana</a>. This package provides different methods and databases for the analysis of intercellular interactions based on scRNA-seq data in the AnnData format. In this Tutorial, we describe our recommendation for using the liana package in python.</p>
<p>First of all, the libraries necessary for using liana must be loaded:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true"></a><span class="im">import</span> scanpy <span class="im">as</span> sc</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true"></a><span class="im">import</span> liana <span class="im">as</span> li</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true"></a><span class="im">import</span> os</span></code></pre></div>
<p>We assume here that the necessary libraries are already installed.</p>
<p>Then, before perfoming the analysis, we need to load the AnnData object with the scRNA-seq data</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true"></a>data <span class="op">=</span> sc.read_h5ad(<span class="st">"/path/to/AnnData/file.h5ad"</span>)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true"></a>data.raw <span class="op">=</span> data</span></code></pre></div>
<p>As mentioned at the beginning, there are different methods and databases implemented in the liana package. We recommend using the CellphoneDB analysis in combination with the consensus database with intercellular interactions. Note that metadata fields for the available sample/conditions (field_with_condition) and for the cell annotations (field_with_cell_annotation) are still specified by the user.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">set</span>(data.obs[<span class="st">'protocol'</span>]):</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true"></a>    <span class="bu">print</span>(i)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true"></a>    lr<span class="op">=</span>li.method.cellphonedb(data[data.obs[<span class="st">'protocol'</span>]<span class="op">==</span>i],</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true"></a>                          groupby<span class="op">=</span><span class="st">'new_annotation'</span>,</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true"></a>                          expr_prop<span class="op">=</span><span class="fl">0.1</span>,</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true"></a>                          verbose<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true"></a>                          resource_name<span class="op">=</span><span class="st">'consensus'</span>,</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true"></a>                          inplace<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true"></a>    lr.to_csv(<span class="ss">f"</span><span class="sc">{i}</span><span class="ss">_lr_liana_consensus_unfiltered.csv"</span>)</span></code></pre></div>
<p>Finally, the result tables are filtered by the CellphoneDB p-value (here in the example p-val &lt; 0.05) and converted into the CrossTalkeR input format. By default, the interaction table used for CrossTalkeR should contain the columns “source”, “target”, “type_gene_A”, “gene_A”, “type_gene_B”, “gene_B” and “MeanLR”.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true"></a>data <span class="op">=</span> {}</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true"></a><span class="cf">for</span> i <span class="kw">in</span> os.listdir():</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true"></a>    <span class="cf">if</span> i.endswith(<span class="st">'lr_liana_consensus_unfiltered.csv'</span>):</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true"></a>        evfull <span class="op">=</span> pd.read_csv(i)</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true"></a>        evfull <span class="op">=</span> evfull.loc[:,[<span class="st">'ligand'</span>,<span class="st">'receptor'</span>,<span class="st">'source'</span>,<span class="st">'target'</span>,<span class="st">'lr_means'</span>,<span class="st">'cellphone_pvals'</span>]]</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true"></a>        evfull[<span class="st">'type_gene_A'</span>] <span class="op">=</span> <span class="st">'Ligand'</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true"></a>        evfull[<span class="st">'type_gene_B'</span>] <span class="op">=</span> <span class="st">'Receptor'</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true"></a>        evfull[<span class="st">'gene_A'</span>] <span class="op">=</span> evfull[<span class="st">'ligand'</span>]</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true"></a>        evfull[<span class="st">'gene_B'</span>] <span class="op">=</span> evfull[<span class="st">'receptor'</span>]</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true"></a>        evfull[<span class="st">'MeanLR'</span>] <span class="op">=</span> evfull[<span class="st">'lr_means'</span>]</span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true"></a>        k<span class="op">=</span>i[<span class="dv">0</span>:i.find(<span class="st">'_lr_'</span>)]</span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true"></a>        evfull <span class="op">=</span> evfull.loc[<span class="bu">list</span>(evfull.cellphone_pvals.to_numpy()<span class="op">&lt;=</span><span class="fl">0.05</span>),:]</span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true"></a>        evfull.loc[:, [<span class="st">'source'</span>, <span class="st">'target'</span>, <span class="st">'type_gene_A'</span>, <span class="st">'type_gene_B'</span>, <span class="st">'gene_A'</span>, <span class="st">'gene_B'</span>, <span class="st">'MeanLR'</span>]].to_csv(<span class="ss">f'</span><span class="sc">{k}</span><span class="ss">_lr_ready.csv'</span>)</span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true"></a>        data[k]<span class="op">=</span>os.path.abspath(<span class="ss">f'</span><span class="sc">{k}</span><span class="ss">_lr_ready.csv'</span>)</span></code></pre></div>
</div>
<div class="section level3">
<h3 id="running-crosstalker">Running CrossTalkeR<a class="anchor" aria-label="anchor" href="#running-crosstalker"></a>
</h3>
<p>First, we need to import the CrossTalkeR package and define a named list of either the paths to the Ligand-Receptor interaction tables, or directly dataframe objects for each condition of interest. Please note that it is possible to run CrossTalkeR with more than two conditions. Here we load the files from within the package. We can further define a path where we like to save our results (output) and run CrossTalkeR with the generate_report() function:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/CostaLab/CrossTalkeR" class="external-link">CrossTalkeR</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r.igraph.org/" class="external-link">igraph</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://stringr.tidyverse.org" class="external-link">stringr</a></span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">CTR</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">EXP</span><span class="op">)</span></span>
<span><span class="va">paths</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">'CTR'</span><span class="op">=</span><span class="va">CTR</span>,</span>
<span>              <span class="st">'EXP'</span><span class="op">=</span><span class="va">EXP</span><span class="op">)</span></span>
<span></span>
<span><span class="va">output</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, package <span class="op">=</span> <span class="st">"CrossTalkeR"</span><span class="op">)</span></span>
<span><span class="va">ctkroutput</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/generate_report.html">generate_report</a></span><span class="op">(</span><span class="va">paths</span>,</span>
<span>                out_path<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">output</span>,<span class="st">'/'</span><span class="op">)</span>,</span>
<span>                out_file <span class="op">=</span> <span class="st">'vignettes_example.html'</span>,</span>
<span>                output_fmt <span class="op">=</span> <span class="st">"html_document"</span>,</span>
<span>                report <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                filtered_net<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p>Besides passing the paths to the interaction tables and the output folder, we here also define: out_file - A suffix for the result reports output_fmt - The file type of the result reports report - A boolean value if the reports should be created at all</p>
<p>As result of the successful execution, we receive three seurat objects (LR_data.Rds, LR_data_step2.Rds and LR_data_final.Rds), as well as two html-reports(SingleCondition.html and ComparativeCondition.html). The LR_data_final.Rds contains all results produced by CrossTalkeR and the two html-reports contain the visualization of the results inside the R object. It is possible to load the results of the CrossTalkeR analysis from the “LR_data_final.Rds” R-object and produce the plots separately. In the following we are going to take a look at different results within the two reports, step by step.</p>
</div>
<div class="section level3">
<h3 id="single-condition-report">Single Condition Report<a class="anchor" aria-label="anchor" href="#single-condition-report"></a>
</h3>
<p>The first report contains the results for each analysed condition considered separately. In our case in each section is a plot for the CTR condition (CTR) and the disease condition (EXP). There are two main sections in the report. The first one only deals with cell-cell-interactions and the second with cell-gene-interactions, which here means an analysis at the ligand and receptor gene level.</p>
<div class="section level4">
<h4 id="cell-cell-interaction-analysis-results">Cell-Cell-Interaction Analysis Results<a class="anchor" aria-label="anchor" href="#cell-cell-interaction-analysis-results"></a>
</h4>
<p>The cell-cell-interaction (CCI) graph plots focus on the interactions between the different cell types within the data. We focus on three measures inside this plot:</p>
<ol style="list-style-type: decimal">
<li>Percentage of interactions indicated by the opacity of the arrows</li>
<li>Edge weight (sum of single L-R interaction scores between cell type pairs) indicated by the edge color</li>
<li>Pagerank (Node importance) indicated by the node size</li>
</ol>
<p>After loading the result data from the “LR_data_final.Rds”, we can plot the cell-cell interactions with the plot_cci() function. Here we show a plot for each analysed condition:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">ctkroutput</span><span class="op">)</span></span>
<span><span class="va">data</span> <span class="op">&lt;-</span> <span class="va">ctkroutput</span> </span>
<span><span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plot_cci.html">plot_cci</a></span><span class="op">(</span>graph <span class="op">=</span> <span class="va">data</span><span class="op">@</span><span class="va">graphs</span><span class="op">$</span><span class="va">CTR</span>,</span>
<span>        colors <span class="op">=</span> <span class="va">data</span><span class="op">@</span><span class="va">colors</span>,</span>
<span>        plt_name <span class="op">=</span> <span class="st">'Control'</span>,</span>
<span>        coords <span class="op">=</span> <span class="va">data</span><span class="op">@</span><span class="va">coords</span><span class="op">[</span><span class="fu"><a href="https://r.igraph.org/reference/V.html" class="external-link">V</a></span><span class="op">(</span><span class="va">data</span><span class="op">@</span><span class="va">graphs</span><span class="op">$</span><span class="va">CTR</span><span class="op">)</span><span class="op">$</span><span class="va">name</span>,<span class="op">]</span>,</span>
<span>        emax <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>        leg <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>        low <span class="op">=</span> <span class="fl">0</span>,</span>
<span>        high <span class="op">=</span> <span class="fl">0</span>,</span>
<span>        ignore_alpha <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>        log <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>        efactor <span class="op">=</span> <span class="fl">8</span>,</span>
<span>        vfactor <span class="op">=</span> <span class="fl">12</span>,</span>
<span>        pg <span class="op">=</span> <span class="va">data</span><span class="op">@</span><span class="va">rankings</span><span class="op">[[</span><span class="st">"CTR"</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">Pagerank</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plot_cci.html">plot_cci</a></span><span class="op">(</span>graph <span class="op">=</span> <span class="va">data</span><span class="op">@</span><span class="va">graphs</span><span class="op">$</span><span class="va">EXP</span>,</span>
<span>        colors <span class="op">=</span> <span class="va">data</span><span class="op">@</span><span class="va">colors</span>,</span>
<span>        plt_name <span class="op">=</span> <span class="st">'Disease'</span>,</span>
<span>        coords <span class="op">=</span> <span class="va">data</span><span class="op">@</span><span class="va">coords</span><span class="op">[</span><span class="fu"><a href="https://r.igraph.org/reference/V.html" class="external-link">V</a></span><span class="op">(</span><span class="va">data</span><span class="op">@</span><span class="va">graphs</span><span class="op">$</span><span class="va">EXP</span><span class="op">)</span><span class="op">$</span><span class="va">name</span>,<span class="op">]</span>,</span>
<span>        emax <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>        leg <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>        low <span class="op">=</span> <span class="fl">0</span>,</span>
<span>        high <span class="op">=</span> <span class="fl">0</span>,</span>
<span>        ignore_alpha <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>        log <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>        efactor <span class="op">=</span> <span class="fl">8</span>,</span>
<span>        vfactor <span class="op">=</span> <span class="fl">12</span>,</span>
<span>        pg <span class="op">=</span> <span class="va">data</span><span class="op">@</span><span class="va">rankings</span><span class="op">[[</span><span class="st">"EXP"</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">Pagerank</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">p1</span><span class="op">+</span><span class="va">p2</span><span class="op">)</span></span></code></pre></div>
<p><img src="HumanFibrosis_files/figure-html/vignete2-1.png" width="960"><img src="HumanFibrosis_files/figure-html/vignete2-2.png" width="960"></p>
<p>In the CTR plot we can see that a high proportion of interactions are MSCs talking with themselves as well as MSC and Myeloid cells talking with each other. These interaction have also a higher weight, as can be seen by the edge color. The most important nodes by pagerank are also the MSC and Myeloid nodes. When analysing the plot of the EXP condition, we see again a high proportions of interactions are self-talking MSCs and one of the most important nodes by pagerank is again the MSC node. Here, the MSCs are predicted to talk more to Megakaryocytes than with the Myeloid cells. To really compare the two conditions we recommend using the comparative report results.</p>
</div>
<div class="section level4">
<h4 id="analysis-on-the-gene-cell-interaction-level">Analysis on the Gene-Cell Interaction Level<a class="anchor" aria-label="anchor" href="#analysis-on-the-gene-cell-interaction-level"></a>
</h4>
<p>We provide several different possibilities to analyse the ligand-receptor interactions on the gene level. In CrossTalkeR, topological network measures are calculated for each node(gene) in the build networks. These measures include Influencer (depending on outgoing edges), Listener(depending on incoming edges), Mediator (depending on outgoing and incoming edges), and Pagerank (overall importance) rankings. The ligand and receptors can be ranked by these measures and we can identify possibly relevant genes by considering the top genes of the rankings. In the report we provide an interactive table with all the rankings for each gene in the network. Here is an example for the top 10 genes in the Pagerank ranking for both preset conditions in form of Barplots:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rankings_table</span> <span class="op">&lt;-</span> <span class="va">data</span><span class="op">@</span><span class="va">rankings</span><span class="op">$</span><span class="va">CTR_ggi</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">arrange</span><span class="op">(</span><span class="va">Pagerank</span><span class="op">)</span></span>
<span><span class="va">rankings_table</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">tail</a></span><span class="op">(</span><span class="va">rankings_table</span>, n<span class="op">=</span><span class="fl">10</span><span class="op">)</span></span>
<span><span class="va">signal</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">rankings_table</span><span class="op">$</span><span class="va">Pagerank</span> <span class="op">&lt;</span> <span class="fl">0</span>, <span class="st">'negative'</span>, <span class="st">'positive'</span><span class="op">)</span></span>
<span><span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">rankings_table</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Pagerank</span>, y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/reorder.factor.html" class="external-link">reorder</a></span><span class="op">(</span><span class="va">nodes</span>, <span class="va">Pagerank</span><span class="op">)</span>, fill <span class="op">=</span> <span class="va">signal</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>        <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html" class="external-link">geom_bar</a></span><span class="op">(</span>stat <span class="op">=</span> <span class="st">"identity"</span><span class="op">)</span> <span class="op">+</span></span>
<span>        <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_fill_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">Blue2DarkOrange18Steps</span><span class="op">[</span><span class="fl">14</span><span class="op">]</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>        <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>        <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Top Listener in Control Condition"</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="va">rankings_table</span> <span class="op">&lt;-</span> <span class="va">data</span><span class="op">@</span><span class="va">rankings</span><span class="op">$</span><span class="va">EXP_ggi</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">arrange</span><span class="op">(</span><span class="va">Pagerank</span><span class="op">)</span></span>
<span><span class="va">rankings_table</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">tail</a></span><span class="op">(</span><span class="va">rankings_table</span>, n<span class="op">=</span><span class="fl">10</span><span class="op">)</span></span>
<span><span class="va">signal</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">rankings_table</span><span class="op">$</span><span class="va">Pagerank</span> <span class="op">&lt;</span> <span class="fl">0</span>, <span class="st">'negative'</span>, <span class="st">'positive'</span><span class="op">)</span></span>
<span><span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">rankings_table</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Pagerank</span>, y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/reorder.factor.html" class="external-link">reorder</a></span><span class="op">(</span><span class="va">nodes</span>, <span class="va">Pagerank</span><span class="op">)</span>, fill <span class="op">=</span> <span class="va">signal</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>        <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_fill_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">Blue2DarkOrange18Steps</span><span class="op">[</span><span class="fl">14</span><span class="op">]</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>        <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html" class="external-link">geom_bar</a></span><span class="op">(</span>stat <span class="op">=</span> <span class="st">"identity"</span><span class="op">)</span> <span class="op">+</span></span>
<span>        <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>        <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Top Listener in Disease Condition"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">p1</span><span class="op">+</span><span class="va">p2</span><span class="op">)</span></span></code></pre></div>
<p><img src="HumanFibrosis_files/figure-html/vignete3-1.png" width="960"></p>
<p>It is possible to perform further analysis on the gene-gene-level regarding the other topological measures, but we focus on the result of these more in the condition comparison results described in the next section.</p>
</div>
</div>
<div class="section level3">
<h3 id="compared-condition-results">Compared Condition Results<a class="anchor" aria-label="anchor" href="#compared-condition-results"></a>
</h3>
<p>CrossTalkeR not only analyzes the conditions individually but also calculates the differences in the cell-cell interactions between the conditions. The results of these analyses are presented in the comparative report. In our example we compare the EXP against the CTR condition.</p>
<div class="section level4">
<h4 id="cell-cell-interaction-analysis-results-1">Cell-Cell-Interaction analysis results<a class="anchor" aria-label="anchor" href="#cell-cell-interaction-analysis-results-1"></a>
</h4>
<p>As before for the single condition results, the first part of the results deal with cell-cell interactions. Here we show again the CCI graph plot, but now for the compared conditions:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_cci.html">plot_cci</a></span><span class="op">(</span>graph <span class="op">=</span> <span class="va">data</span><span class="op">@</span><span class="va">graphs</span><span class="op">$</span><span class="va">EXP_x_CTR</span>,</span>
<span>        colors <span class="op">=</span> <span class="va">data</span><span class="op">@</span><span class="va">colors</span>,</span>
<span>        plt_name <span class="op">=</span> <span class="st">'Disease vs Control'</span>,</span>
<span>        coords <span class="op">=</span> <span class="va">data</span><span class="op">@</span><span class="va">coords</span><span class="op">[</span><span class="fu"><a href="https://r.igraph.org/reference/V.html" class="external-link">V</a></span><span class="op">(</span><span class="va">data</span><span class="op">@</span><span class="va">graphs</span><span class="op">$</span><span class="va">EXP_x_CTR</span><span class="op">)</span><span class="op">$</span><span class="va">name</span>,<span class="op">]</span>,</span>
<span>        emax <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>        leg <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>        low <span class="op">=</span> <span class="fl">0</span>,</span>
<span>        high <span class="op">=</span> <span class="fl">0</span>,</span>
<span>        ignore_alpha <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>        log <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>        efactor <span class="op">=</span> <span class="fl">8</span>,</span>
<span>        vfactor <span class="op">=</span> <span class="fl">12</span>, pg <span class="op">=</span> <span class="va">data</span><span class="op">@</span><span class="va">rankings</span><span class="op">[[</span><span class="st">"EXP_x_CTR"</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">Pagerank</span><span class="op">)</span></span></code></pre></div>
<p><img src="HumanFibrosis_files/figure-html/vignete4-1.png" width="960"> The main difference from the previous CCI graph plots is that the edge weights can now be not only positive but also negative, as well as the Pagerank values of the nodes. Positive values mean that these interactions between cell types have a higher activity/importance in the EXP condition, while negative values indicate a lower activity/importannce in the EXP condition (higher in CTR). As we can see in the CCI plot above, there are equally positive and negative edge weights present. The edge weights between MSCs and Megakaryocytes are positive up in both directions in the Disease condition. Thus, we can conclude that the communication is stronger in the EXP example. In contrast, the edge weights between the MSC and Myeloid nodes have negative edge weights, meaning these communication are lower in the EXP condition. Further, the self communication edge of the MSC node has a strong negative weight and also the pagerank is very small (indicated by small node size). This indicates that MSCs are more important in the CCIs in the CTR condition.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">EnhancedVolcano</span><span class="op">(</span><span class="va">data</span><span class="op">@</span><span class="va">stats</span><span class="op">$</span><span class="va">EXP_x_CTR</span>, lab<span class="op">=</span><span class="va">data</span><span class="op">@</span><span class="va">stats</span><span class="op">$</span><span class="va">EXP_x_CTR</span><span class="op">$</span><span class="va">columns_name</span>,x<span class="op">=</span><span class="st">'lodds'</span>,y<span class="op">=</span><span class="st">'p'</span>,pCutoff<span class="op">=</span><span class="fl">0.05</span><span class="op">)</span></span></code></pre></div>
<p><img src="HumanFibrosis_files/figure-html/vignete451-1.png" width="960"></p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_cci.html">plot_cci</a></span><span class="op">(</span>graph <span class="op">=</span> <span class="va">data</span><span class="op">@</span><span class="va">graphs</span><span class="op">$</span><span class="va">EXP_x_CTR_filtered</span>,</span>
<span>        colors <span class="op">=</span> <span class="va">data</span><span class="op">@</span><span class="va">colors</span>,</span>
<span>        plt_name <span class="op">=</span> <span class="st">'Disease vs Control Fisher Test Filtered'</span>,</span>
<span>        coords <span class="op">=</span> <span class="va">data</span><span class="op">@</span><span class="va">coords</span><span class="op">[</span><span class="fu"><a href="https://r.igraph.org/reference/V.html" class="external-link">V</a></span><span class="op">(</span><span class="va">data</span><span class="op">@</span><span class="va">graphs</span><span class="op">$</span><span class="va">EXP_x_CTR_filtered</span><span class="op">)</span><span class="op">$</span><span class="va">name</span>,<span class="op">]</span>,</span>
<span>        emax <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>        leg <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>        low <span class="op">=</span> <span class="fl">0</span>,</span>
<span>        high <span class="op">=</span> <span class="fl">0</span>,</span>
<span>        ignore_alpha <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>        log <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>        efactor <span class="op">=</span> <span class="fl">8</span>,</span>
<span>        vfactor <span class="op">=</span> <span class="fl">12</span>, pg <span class="op">=</span> <span class="va">data</span><span class="op">@</span><span class="va">rankings</span><span class="op">[[</span><span class="st">"EXP_x_CTR_filtered"</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">Pagerank</span><span class="op">)</span></span></code></pre></div>
<p><img src="HumanFibrosis_files/figure-html/vignete452-1.png" width="960"> CrossTalkeR offers a refined CCI graph by employing Fisher’s exact test to filter the network based on interaction proportions. In this small example, the interactions with Fibroblasts and Neural cells are removed from the network applying the tests results. The before described interactions between MSCs, Megakaryocytes and Myeloid cells are still retained, further indicating the importance in the communication. Since this example data is small, we going to continue using the unfiltered network in the following steps. The filtered CCI graph is mostly helpful for large communication networks.</p>
<p>Since we have created a CCI network we can also analyze it based on topological properties to identify possible biologically relevant processes. For this purpose, the same topological measures can be used that are present in the single condition results for gene-cell interactions analysis (Influencer, Listener, Mediator, Pagerank). As before, we can look at the rankings individually in the form of bar plots. Here is an example for the Pagerank of cell types in the network:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_bar_rankings.html">plot_bar_rankings</a></span><span class="op">(</span><span class="va">data</span>, <span class="st">"EXP_x_CTR"</span>, <span class="st">"Pagerank"</span>, type <span class="op">=</span> <span class="cn">NULL</span>, filter_sign <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span></code></pre></div>
<p><img src="HumanFibrosis_files/figure-html/vignete5-1.png" width="960"></p>
<p>In our comparison, the Megakaryocytes have the highest pagerank, which suggest a high importance in our network for the EXP condition. In the negative direction, Myeloid cells has the lowest Pagerank. This suggest a higher importance in the CTR condition. By considering now also the other topological measures, we can assign/find other communication properties of the cell types:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_bar_rankings.html">plot_bar_rankings</a></span><span class="op">(</span><span class="va">data</span>, <span class="st">"EXP_x_CTR"</span>, <span class="st">"Influencer"</span>, type <span class="op">=</span> <span class="cn">NULL</span>, filter_sign <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span></code></pre></div>
<p><img src="HumanFibrosis_files/figure-html/vignete7_Influencer-1.png" width="960"></p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_bar_rankings.html">plot_bar_rankings</a></span><span class="op">(</span><span class="va">data</span>, <span class="st">"EXP_x_CTR"</span>, <span class="st">"Listener"</span>, type <span class="op">=</span> <span class="cn">NULL</span>, filter_sign <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span></code></pre></div>
<p><img src="HumanFibrosis_files/figure-html/vignete7_Influencer-2.png" width="960"></p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_bar_rankings.html">plot_bar_rankings</a></span><span class="op">(</span><span class="va">data</span>, <span class="st">"EXP_x_CTR"</span>, <span class="st">"Mediator"</span>, type <span class="op">=</span> <span class="cn">NULL</span>, filter_sign <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span></code></pre></div>
<p><img src="HumanFibrosis_files/figure-html/vignete7_Influencer-3.png" width="960"></p>
<p>Including the Influencer, Listener and Mediator barplots reveals that Megakaryocytes have the highest PageRank, Influencer, and Listener scores, indicating they engage in the most significant interactions in the EXP condition. However, their Mediator score is negative, suggesting a stronger mediating role in the CTR condition.</p>
<p>In contrast, Myeloid cells show high negative scores across most metrics except for the Influencer score, emphasizing their importance in the CTR condition. These findings highlight the differing roles of these cell types in EXP versus normal states.</p>
</div>
<div class="section level4">
<h4 id="cell-gene-interaction-analysis-results">Cell-Gene-Interaction Analysis Results<a class="anchor" aria-label="anchor" href="#cell-gene-interaction-analysis-results"></a>
</h4>
<p>The second part of the report deals again with the interactions on the gene level. Here, the procedure is similar to the one described in the last section for the cell-cell interactions and the analysis performed for the single conditions. First of all, we can look at the results of the topological rankings in the form of bar plots, again using the example of the pagerank:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_bar_rankings.html">plot_bar_rankings</a></span><span class="op">(</span><span class="va">data</span>, <span class="st">"EXP_x_CTR_ggi"</span>, <span class="st">"Pagerank"</span>, type <span class="op">=</span> <span class="cn">NULL</span>, filter_sign <span class="op">=</span> <span class="cn">NULL</span>, mode <span class="op">=</span> <span class="st">"cgi"</span><span class="op">)</span></span></code></pre></div>
<p><img src="HumanFibrosis_files/figure-html/vignete9-1.png" width="960"></p>
<p>The plot highlights the ligand and receptor genes that play significant roles in different conditions. Notably, the top genes in both positive and negative directions are predominantly receptor genes. Specifically, the majority of positively scored genes are receptor genes from Megakaryocytes, while the top negatively scored genes are associated with Myeloid cells.</p>
<p>Among the key receptors, ITGB1 is upregulated in Megakaryocytes, while ITGA1 is downregulated in MSCs. Additionally, the score of CXCR4 is also elevated in Megakaryocytes. For further insights, we encourage examining the other rankings. Given that we are focusing on pairwise interactions, our analysis will concentrate on the Influencer and Listener rankings:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_bar_rankings.html">plot_bar_rankings</a></span><span class="op">(</span><span class="va">data</span>, <span class="st">"EXP_x_CTR_ggi"</span>, <span class="st">"Influencer"</span>, type <span class="op">=</span> <span class="st">"L"</span>, filter_sign <span class="op">=</span> <span class="cn">NULL</span>, mode <span class="op">=</span> <span class="st">"cgi"</span><span class="op">)</span></span></code></pre></div>
<p><img src="HumanFibrosis_files/figure-html/vignete9_other-1.png" width="960"></p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_bar_rankings.html">plot_bar_rankings</a></span><span class="op">(</span><span class="va">data</span>, <span class="st">"EXP_x_CTR_ggi"</span>, <span class="st">"Listener"</span>, type <span class="op">=</span> <span class="st">"R"</span>, filter_sign <span class="op">=</span> <span class="cn">NULL</span>, mode <span class="op">=</span> <span class="st">"cgi"</span><span class="op">)</span></span></code></pre></div>
<p><img src="HumanFibrosis_files/figure-html/vignete9_other-2.png" width="960"></p>
<p>The top Influencer in EXP condition identified is TGFB1 in Megakaryocytes. Also COL1A1 and COL1A2 from MSCs rank high on the positive side. CXCL12 from MSCs as example has a negative Influencer ranking. In the Listener category, integrin receptors dominate, but there are also receptors as CXCR4 and LRP1 ranking high/low.</p>
</div>
</div>
</div>
<div class="section level2">
<h2 id="follow-up-analysis">Follow-up Analysis<a class="anchor" aria-label="anchor" href="#follow-up-analysis"></a>
</h2>
<p>Since we got a first impression of the data with the previous results, we can further deepen the analysis. For example, we had TGFB1 in Megakaryocytes, ITGB1 in Megakaryocytes, Fibroblasts and MSCs and CXCR4 in Megakaryocytes and Myeloid cells as interesting genes. With CrossTalkeR, we can look even more closely at the interactions involving these genes using Sankey plots. There are two ways to do this. First, we can regenerate the report again, this time passing a list of genes of interest:</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">genes_of_interest</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'TGFB1|L'</span>,</span>
<span>                       <span class="st">'ITGB1|R'</span>,</span>
<span>                       <span class="st">'CXCR4|R'</span><span class="op">)</span></span>
<span></span>
<span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/make_report.html">make_report</a></span><span class="op">(</span>out_path<span class="op">=</span><span class="va">output</span>,</span>
<span>                    genes <span class="op">=</span> <span class="va">genes_of_interest</span>,</span>
<span>                    out_file <span class="op">=</span> <span class="st">'vignettes_example.html'</span>,</span>
<span>                    output_fmt <span class="op">=</span> <span class="st">"html_document"</span>,</span>
<span>                    report <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                    org <span class="op">=</span> <span class="st">"hsa"</span><span class="op">)</span></span></code></pre></div>
<p>The second option is to plot only the Sankey plots for the genes of interests, without redoing the report:</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_sankey.html">plot_sankey</a></span><span class="op">(</span><span class="va">data</span><span class="op">@</span><span class="va">tables</span><span class="op">$</span><span class="va">EXP_x_CTR</span>,</span>
<span>            target <span class="op">=</span> <span class="st">"TGFB1|L"</span>,</span>
<span>            ligand_cluster <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>            receptor_cluster <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>            plt_name <span class="op">=</span> <span class="st">"TGFB1 ligand gene interactions EXP vs CTR"</span>,</span>
<span>            threshold <span class="op">=</span> <span class="fl">50</span>, tfflag <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p><img src="HumanFibrosis_files/figure-html/unnamed-chunk-8-1.png" width="1056"></p>
<p>In the Sankey plot, not all interactions involving the TGFB1 ligand gene are shown, but only those with a high score. The number of actual interactions can be controlled with the threshold parameter. In the example above 50 interactions are selected. Since we have only entered one target gene without any further information, we can now also see interactions originating from different cell types, here Fibroblasts, Megakaryocytes and MSCs. Furthermore, we now have a list of receptors with associated cell types with which the TGFB1 ligand can possibly interact. The list also includes the receptor ITGB1 in Megakaryocytes, which was also a gene of interest. The interaction between TGFB1 and ITGB1 has a positive score, which means it is enriched in the EXP condition.</p>
<p>The third gene of interest was the receptor gene CXCR4 with a high importance in Megakaryocytes in the EXP condition and in Myeloid cells in the CTR condition. If we want to focus only on CXCR4 in Megakaryocytes and Myeloid cells, we can define a receptor_cluster value when running the Sankey plot function. Also, the number of interactions included is reduced by setting the threshold parameter to 15.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_sankey.html">plot_sankey</a></span><span class="op">(</span><span class="va">data</span><span class="op">@</span><span class="va">tables</span><span class="op">$</span><span class="va">EXP_x_CTR</span>,</span>
<span>            target <span class="op">=</span> <span class="st">"CXCR4|R"</span>,</span>
<span>            ligand_cluster <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>            receptor_cluster <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Megakaryocyte"</span>, <span class="st">"Myeloid"</span><span class="op">)</span>,</span>
<span>            plt_name <span class="op">=</span> <span class="st">"Megakaryocyte and  Myeloid CXCR4 receptor gene interaction EXP vs CTR"</span>,</span>
<span>            threshold <span class="op">=</span> <span class="fl">15</span>, tfflag <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p><img src="HumanFibrosis_files/figure-html/unnamed-chunk-9-1.png" width="1056"></p>
<p>The Sankey plot confirms that the LR Score indicates higher interaction with CXCR4 in Megakaryocytes under EXP condition and in Myeloid cells under CTR condition. Additionally, it highlights previously occuring ligand and receptors, including TGFB ligand from Megakaryocytes to CXCR4 in Megakaryocytes and CXCL12 from MSCs to CXCR4 in both Megakaryocytes and Myeloid cells.</p>
</div>
<div class="section level2">
<h2 id="report-samples">Report Samples<a class="anchor" aria-label="anchor" href="#report-samples"></a>
</h2>
<p><a href="https://github.com/CostaLab/CrossTalkeR/blob/master/inst/extdata/Single_vignettes_example.html" class="external-link">Single Condition Report</a></p>
<p><a href="https://github.com/CostaLab/CrossTalkeR/blob/master/inst/extdata/Comparative_vignettes_example.html" class="external-link">Comparative Condition Report</a></p>
</div>
<div class="section level2">
<h2 id="further-tutorials">Further Tutorials<a class="anchor" aria-label="anchor" href="#further-tutorials"></a>
</h2>
<p>If you want to learn more about how to infer ligand and receptor interactions with liana and how to use it with CrossTalkeR, check out this tutorial: <a href="https://costalab.github.io/CrossTalkeR/articles/run_liana.html" class="external-link">Run liana</a>.</p>
<p><br><br><br><br></p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Vanessa Kloeker, James Shiniti Nagai, Nils Leimkühler, Michael T. Schaub, Rebekka Schneider, Ivan Costa Gesteira.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

      </footer>
</div>






  </body>
</html>
